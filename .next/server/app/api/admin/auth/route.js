(()=>{var e={};e.id=266,e.ids=[266],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},87529:()=>{},70934:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>g,staticGenerationAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>l,POST:()=>d});var a=r(49303),i=r(88716),n=r(60670),o=r(87070),c=r(95456),u=r(66299);let p="corpepilates_session";async function l(e){let t=e.cookies.get(p)?.value;if(!t)return o.NextResponse.json({authenticated:!1});let r=await (0,c.X7)(t);return o.NextResponse.json({authenticated:r})}async function d(e){let{action:t,password:r,otp:s,newPassword:a}=await e.json();if("login"===t){if(await (0,c.Gv)(r)){let e=await (0,c.kt)(),t=o.NextResponse.json({success:!0});return t.cookies.set(p,e,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:432e3,path:"/"}),t}return o.NextResponse.json({error:"Contrase\xf1a incorrecta"},{status:401})}if("logout"===t){let t=e.cookies.get(p)?.value;t&&await (0,c.TQ)(t);let r=o.NextResponse.json({success:!0});return r.cookies.delete(p),r}if("check"===t){let t=e.cookies.get(p)?.value;if(!t)return o.NextResponse.json({authenticated:!1});let r=await (0,c.X7)(t);return o.NextResponse.json({authenticated:r})}if("request_otp"===t){let e=(await (0,u.QN)()).site.email;if(!e)return o.NextResponse.json({error:"No hay email configurado. Guard\xe1 primero un email de contacto."},{status:400});let t=await (0,c.P)(),r=await (0,c.a2)(e,t);if(r.success){let t=e.replace(/(.{2})(.*)(@.*)/,"$1***$3");return o.NextResponse.json({success:!0,email:t})}return o.NextResponse.json({error:r.error||"Error al enviar el c\xf3digo"},{status:500})}if("verify_otp"===t)return await (0,c.qD)(s,!1)?o.NextResponse.json({success:!0,verified:!0}):o.NextResponse.json({error:"C\xf3digo inv\xe1lido o expirado"},{status:400});if("change_password"===t)return await (0,c.qD)(s,!1)?!a||a.length<6?o.NextResponse.json({error:"La contrase\xf1a debe tener al menos 6 caracteres"},{status:400}):await (0,c.sp)(a)?(await (0,c.Bx)(),o.NextResponse.json({success:!0})):o.NextResponse.json({error:"Error al guardar la contrase\xf1a"},{status:500}):o.NextResponse.json({error:"C\xf3digo inv\xe1lido o expirado"},{status:400});if("has_custom_password"===t){let e=await (0,c.P0)();return o.NextResponse.json({hasCustomPassword:!!e})}return o.NextResponse.json({error:"Acci\xf3n no v\xe1lida"},{status:400})}let f=new a.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/auth/route",pathname:"/api/admin/auth",filename:"route",bundlePath:"app/api/admin/auth/route"},resolvedPagePath:"C:\\Users\\agusk\\Desktop\\Stuff\\Projects\\PilatesReformer\\src\\app\\api\\admin\\auth\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:m,staticGenerationAsyncStorage:x,serverHooks:g}=f,h="/api/admin/auth/route";function y(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:x})}},58867:(e,t,r)=>{"use strict";r.d(t,{T4:()=>a,TD:()=>i,mH:()=>o,mr:()=>n,u_:()=>s});let s={site:{siteName:"Corpe Pilates",tagline:"Pilates Reformer para todos",instagram:"https://instagram.com/corpepilates",whatsapp:"5491161515110",email:"corpepilates@gmail.com",location:"Avenida Segurola 386, Floresta, CABA",deliveryMode:"pickup",productsEnabled:!1},booking:{enabled:!0,recurring:[{dayOfWeek:2,slots:[{start:"18:00",end:"19:00"}]},{dayOfWeek:5,slots:[{start:"18:00",end:"19:00"}]}],exceptions:[]},products:[],services:[{id:"plan-1x",name:"Plan 1x Semana",description:"4 clases mensuales de Pilates Reformer. Ideal para iniciarte en la pr\xe1ctica y trabajar tu core, postura y fuerza general.",price:25e3,duration:"60 min",durationMinutes:60,image:"https://images.unsplash.com/photo-1518611012118-696072aa579a?w=400&h=400&fit=crop"},{id:"plan-2x",name:"Plan 2x Semana",description:"8 clases mensuales de Pilates Reformer. Perfecto para progresar m\xe1s r\xe1pido y sentir resultados en pocas semanas.",price:4e4,duration:"60 min",durationMinutes:60,image:"https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?w=400&h=400&fit=crop"},{id:"plan-3x",name:"Plan 3x Semana",description:"12 clases mensuales de Pilates Reformer. M\xe1ximos resultados: mayor fuerza, flexibilidad y cuidado de tu columna.",price:55e3,duration:"60 min",durationMinutes:60,image:"https://images.unsplash.com/photo-1599901860904-17e6ed7083a0?w=400&h=400&fit=crop"}]};function a(e){return new Intl.NumberFormat("es-AR",{style:"currency",currency:"ARS",minimumFractionDigits:0,maximumFractionDigits:0}).format(e)}function i(e){let[t,r]=e.split(":").map(Number);return 60*t+r}function n(e){return`${Math.floor(e/60).toString().padStart(2,"0")}:${(e%60).toString().padStart(2,"0")}`}function o(e,t){return n(i(e)+t)}},95456:(e,t,r)=>{"use strict";r.d(t,{Bx:()=>x,Gv:()=>d,P:()=>f,P0:()=>p,TQ:()=>y,X7:()=>h,a2:()=>w,kt:()=>g,qD:()=>m,sp:()=>l});var s=r(55245),a=r(84770),i=r.n(a),n=r(79534);let o="corpepilates:admin_password",c="corpepilates:otp",u="corpepilates:session:";async function p(){try{let e=(0,n.Q)();return await e.get(o)}catch{return null}}async function l(e){try{let t=(0,n.Q)();return await t.set(o,e),!0}catch{return!1}}async function d(e){if(e===(process.env.ADMIN_PASSWORD||"corpepilates2024"))return!0;let t=await p();return!!t&&e===t}async function f(){let e=(0,n.Q)(),t=Math.random().toString().slice(2,8);return await e.setex(c,600,t),t}async function m(e,t=!1){try{let r=(0,n.Q)(),s=await r.get(c),a=String(s||""),i=String(e||"").trim();if(a&&a===i)return t&&await r.del(c),!0;return!1}catch(e){return console.error("Error verificando OTP:",e),!1}}async function x(){try{let e=(0,n.Q)();await e.del(c)}catch{}}async function g(){let e=(0,n.Q)(),t=i().randomBytes(32).toString("hex");return await e.setex(u+t,432e3,JSON.stringify({createdAt:Date.now()})),t}async function h(e){if(!e)return!1;try{let t=(0,n.Q)();return!!await t.get(u+e)}catch{return!1}}async function y(e){try{let t=(0,n.Q)();await t.del(u+e)}catch{}}async function w(e,t){let r=process.env.SMTP_USER,a=process.env.SMTP_PASS,i=process.env.SMTP_HOST||"smtp.gmail.com",n=parseInt(process.env.SMTP_PORT||"465");if(!r||!a)return{success:!1,error:"Email no configurado en el servidor"};try{let o=s.createTransport({host:i,port:n,secure:465===n,auth:{user:r,pass:a}});return await o.sendMail({from:`Corpe Pilates <${r}>`,to:e,subject:"C\xf3digo de verificaci\xf3n - Corpe Pilates Admin",html:`
        <div style="font-family: sans-serif; max-width: 400px; margin: 0 auto; padding: 20px;">
          <h2 style="color: #e85d5d; text-align: center;">Corpe Pilates</h2>
          <p style="text-align: center; color: #666;">Tu c\xf3digo de verificaci\xf3n es:</p>
          <div style="background: #f5f5f5; padding: 20px; text-align: center; border-radius: 10px; margin: 20px 0;">
            <span style="font-size: 32px; font-weight: bold; letter-spacing: 5px; color: #333;">${t}</span>
          </div>
          <p style="text-align: center; color: #999; font-size: 12px;">
            Este c\xf3digo expira en 10 minutos.<br>
            Si no solicitaste este c\xf3digo, ignor\xe1 este email.
          </p>
        </div>
      `}),{success:!0}}catch(e){return console.error("Error sending OTP email:",e),{success:!1,error:e instanceof Error?e.message:"Error desconocido"}}}},79534:(e,t,r)=>{"use strict";r.d(t,{Q:()=>n});var s=r(62197),a=r.n(s);let i=null;function n(){if(!i){let e=process.env.REDIS_URL;if(!e)throw Error("Missing REDIS_URL environment variable");i=new(a())(e)}return i}},66299:(e,t,r)=>{"use strict";r.d(t,{AU:()=>m,HG:()=>g,IF:()=>p,Oh:()=>u,QN:()=>c,Qv:()=>f,TR:()=>x,iD:()=>l,pF:()=>d});var s=r(58867),a=r(79534);let i="corpepilates:config",n="corpepilates:reservations",o="corpepilates:orders";async function c(){try{let e=(0,a.Q)(),t=await e.get(i);if(t)return JSON.parse(t);return s.u_}catch(e){return console.error("Error getting config:",e),s.u_}}async function u(e){try{let t=(0,a.Q)();return await t.set(i,JSON.stringify(e)),!0}catch(e){return console.error("Error saving config:",e),!1}}async function p(){try{let e=(0,a.Q)(),t=await e.get(n);if(t)return JSON.parse(t);return[]}catch{return[]}}async function l(e){try{let t=(0,a.Q)(),r=await p(),s=r.findIndex(t=>t.id===e.id);return s>=0?r[s]=e:r.push(e),await t.set(n,JSON.stringify(r)),!0}catch(e){return console.error("Error saving reservation:",e),!1}}async function d(e){return(await p()).filter(t=>t.date===e&&"cancelled"!==t.status)}async function f(e){return(await p()).find(t=>t.id===e)||null}async function m(){try{let e=(0,a.Q)(),t=await e.get(o);if(t)return JSON.parse(t);return[]}catch{return[]}}async function x(e){try{let t=(0,a.Q)(),r=await m(),s=r.findIndex(t=>t.id===e.id);return s>=0?r[s]=e:r.push(e),await t.set(o,JSON.stringify(r)),!0}catch(e){return console.error("Error saving order:",e),!1}}async function g(e){return(await m()).find(t=>t.id===e)||null}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,197,59,245],()=>r(70934));module.exports=s})();