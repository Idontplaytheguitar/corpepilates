(()=>{var e={};e.id=378,e.ids=[378],e.modules={20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},27790:e=>{"use strict";e.exports=require("assert")},78893:e=>{"use strict";e.exports=require("buffer")},61282:e=>{"use strict";e.exports=require("child_process")},84770:e=>{"use strict";e.exports=require("crypto")},80665:e=>{"use strict";e.exports=require("dns")},17702:e=>{"use strict";e.exports=require("events")},92048:e=>{"use strict";e.exports=require("fs")},32615:e=>{"use strict";e.exports=require("http")},35240:e=>{"use strict";e.exports=require("https")},98216:e=>{"use strict";e.exports=require("net")},19801:e=>{"use strict";e.exports=require("os")},55315:e=>{"use strict";e.exports=require("path")},76162:e=>{"use strict";e.exports=require("stream")},74026:e=>{"use strict";e.exports=require("string_decoder")},82452:e=>{"use strict";e.exports=require("tls")},74175:e=>{"use strict";e.exports=require("tty")},17360:e=>{"use strict";e.exports=require("url")},21764:e=>{"use strict";e.exports=require("util")},71568:e=>{"use strict";e.exports=require("zlib")},87529:()=>{},12070:(e,t,r)=>{"use strict";r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>h,requestAsyncStorage:()=>d,routeModule:()=>f,serverHooks:()=>y,staticGenerationAsyncStorage:()=>x});var s={};r.r(s),r.d(s,{GET:()=>p,POST:()=>l});var i=r(49303),n=r(88716),a=r(60670),o=r(87070),c=r(95579),u=r(95456);async function p(){let e=await (0,c.eA)();return o.NextResponse.json(e)}async function l(e){let t=e.cookies.get("corpepilates_session")?.value;if(!(t&&await (0,u.X7)(t)))return o.NextResponse.json({error:"No autorizado"},{status:401});try{let{enabled:t,percentage:r,developmentPaid:s}=await e.json();"boolean"==typeof s&&await (0,c._d)(s),"boolean"==typeof t&&await (0,c.Bu)(t),"number"==typeof r&&await (0,c.Wc)(r);let i=await (0,c.eA)();return o.NextResponse.json({success:!0,...i})}catch{return o.NextResponse.json({error:"Error al actualizar"},{status:500})}}let f=new i.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/fee/route",pathname:"/api/fee",filename:"route",bundlePath:"app/api/fee/route"},resolvedPagePath:"C:\\Users\\agusk\\Desktop\\Stuff\\Projects\\PilatesReformer\\src\\app\\api\\fee\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:d,staticGenerationAsyncStorage:x,serverHooks:y}=f,g="/api/fee/route";function h(){return(0,a.patchFetch)({serverHooks:y,staticGenerationAsyncStorage:x})}},95456:(e,t,r)=>{"use strict";r.d(t,{Bx:()=>y,Gv:()=>f,P:()=>d,P0:()=>p,TQ:()=>m,X7:()=>h,a2:()=>w,kt:()=>g,qD:()=>x,sp:()=>l});var s=r(55245),i=r(84770),n=r.n(i),a=r(79534);let o="corpepilates:admin_password",c="corpepilates:otp",u="corpepilates:session:";async function p(){try{let e=(0,a.Q)();return await e.get(o)}catch{return null}}async function l(e){try{let t=(0,a.Q)();return await t.set(o,e),!0}catch{return!1}}async function f(e){if(e===(process.env.ADMIN_PASSWORD||"corpepilates2024"))return!0;let t=await p();return!!t&&e===t}async function d(){let e=(0,a.Q)(),t=Math.random().toString().slice(2,8);return await e.setex(c,600,t),t}async function x(e,t=!1){try{let r=(0,a.Q)(),s=await r.get(c),i=String(s||""),n=String(e||"").trim();if(i&&i===n)return t&&await r.del(c),!0;return!1}catch(e){return console.error("Error verificando OTP:",e),!1}}async function y(){try{let e=(0,a.Q)();await e.del(c)}catch{}}async function g(){let e=(0,a.Q)(),t=n().randomBytes(32).toString("hex");return await e.setex(u+t,432e3,JSON.stringify({createdAt:Date.now()})),t}async function h(e){if(!e)return!1;try{let t=(0,a.Q)();return!!await t.get(u+e)}catch{return!1}}async function m(e){try{let t=(0,a.Q)();await t.del(u+e)}catch{}}async function w(e,t){let r=process.env.SMTP_USER,i=process.env.SMTP_PASS,n=process.env.SMTP_HOST||"smtp.gmail.com",a=parseInt(process.env.SMTP_PORT||"465");if(!r||!i)return{success:!1,error:"Email no configurado en el servidor"};try{let o=s.createTransport({host:n,port:a,secure:465===a,auth:{user:r,pass:i}});return await o.sendMail({from:`Corpe Pilates <${r}>`,to:e,subject:"C\xf3digo de verificaci\xf3n - Corpe Pilates Admin",html:`
        <div style="font-family: sans-serif; max-width: 400px; margin: 0 auto; padding: 20px;">
          <h2 style="color: #e85d5d; text-align: center;">Corpe Pilates</h2>
          <p style="text-align: center; color: #666;">Tu c\xf3digo de verificaci\xf3n es:</p>
          <div style="background: #f5f5f5; padding: 20px; text-align: center; border-radius: 10px; margin: 20px 0;">
            <span style="font-size: 32px; font-weight: bold; letter-spacing: 5px; color: #333;">${t}</span>
          </div>
          <p style="text-align: center; color: #999; font-size: 12px;">
            Este c\xf3digo expira en 10 minutos.<br>
            Si no solicitaste este c\xf3digo, ignor\xe1 este email.
          </p>
        </div>
      `}),{success:!0}}catch(e){return console.error("Error sending OTP email:",e),{success:!1,error:e instanceof Error?e.message:"Error desconocido"}}}},95579:(e,t,r)=>{"use strict";r.d(t,{Bu:()=>l,Wc:()=>f,_d:()=>c,eA:()=>d});var s=r(79534);let i="corpepilates:fee_enabled",n="corpepilates:fee_percentage",a="corpepilates:development_paid";async function o(){try{let e=(0,s.Q)(),t=await e.get(a);return"true"===t}catch{return!1}}async function c(e){try{let t=(0,s.Q)();return await t.set(a,e?"true":"false"),e&&await t.set(i,"false"),!0}catch{return!1}}async function u(){try{if(await o())return!1;let e=(0,s.Q)(),t=await e.get(i);return"false"!==t}catch{return!0}}async function p(){try{let e=(0,s.Q)(),t=await e.get(n);return t?parseInt(t):5}catch{return 5}}async function l(e){try{let t=(0,s.Q)();return await t.set(i,e?"true":"false"),!0}catch{return!1}}async function f(e){try{let t=(0,s.Q)();return await t.set(n,e.toString()),!0}catch{return!1}}async function d(){let[e,t,r]=await Promise.all([u(),p(),o()]);return{enabled:e,percentage:t,developmentPaid:r}}},79534:(e,t,r)=>{"use strict";r.d(t,{Q:()=>a});var s=r(62197),i=r.n(s);let n=null;function a(){if(!n){let e=process.env.REDIS_URL;if(!e)throw Error("Missing REDIS_URL environment variable");n=new(i())(e)}return n}}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[276,197,59,245],()=>r(12070));module.exports=s})();